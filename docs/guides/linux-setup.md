# Linux Setup Guide

This guide covers installation and daemon setup for `lowkey` on Linux systems, focusing on distributions that use `systemd`.

## Installation

You can install `lowkey` by building from source or by downloading a pre-compiled binary.

### From Source

Ensure you have Go 1.22+ installed.

```bash
# Clone the repository
git clone https://github.com/onedusk/lowkey.git
cd lowkey

# Build the binary
make build

# Install the binary to a directory in your PATH
sudo cp ./lowkey /usr/local/bin/
```

### From Binary

Download the latest release binary for your architecture from the project's releases page.

```bash
# Example for amd64
wget https://github.com/onedusk/lowkey/releases/latest/download/lowkey-linux-amd64
chmod +x lowkey-linux-amd64
sudo mv lowkey-linux-amd64 /usr/local/bin/lowkey
```

## Daemon Setup with `systemd`

To run `lowkey` as a persistent background service, create a `systemd` unit file.

### 1. Create the Service File

Create a new file at `/etc/systemd/system/lowkey.service`:

```ini
[Unit]
Description=Lowkey Filesystem Monitor
After=network.target
Documentation=https://github.com/onedusk/lowkey

[Service]
Type=simple
User=your-user
Group=your-group
ExecStart=/usr/local/bin/lowkey start --metrics 127.0.0.1:9600 /path/to/monitor
Restart=on-failure
RestartSec=10s

# Security Hardening
ProtectSystem=full
PrivateTmp=true
NoNewPrivileges=true

[Install]
WantedBy=multi-user.target
```

**Note:** Replace `your-user`, `your-group`, and `/path/to/monitor` with your specific user, group, and the directory you want `lowkey` to watch.

### 2. Start and Enable the Service

```bash
# Reload the systemd daemon to recognize the new service
sudo systemctl daemon-reload

# Enable the service to start on boot
sudo systemctl enable lowkey.service

# Start the service immediately
sudo systemctl start lowkey.service
```

## Verification

You can verify that the `lowkey` daemon is running correctly using the following commands.

### Check Service Status

```bash
# Check the status of the lowkey service
sudo systemctl status lowkey.service
```

### Check `lowkey` Status

Use the `lowkey` CLI to check the daemon's internal status and event summary.

```bash
lowkey status
```

### View Logs

To view logs generated by the daemon, you can use `journalctl` or `lowkey tail`.

```bash
# Follow logs in real-time using journalctl
sudo journalctl -u lowkey.service -f

# Tail logs using the built-in lowkey command
lowkey tail
```
